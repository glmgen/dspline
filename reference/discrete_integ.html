<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Discrete integration — discrete_integ • dspline</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Discrete integration — discrete_integ"><meta name="description" content="Computes the discrete integral of a function (or vector of function
evaluations) of a given order, with respect to given design points, and
evaluated at a given query point."><meta property="og:description" content="Computes the discrete integral of a function (or vector of function
evaluations) of a given order, with respect to given design points, and
evaluated at a given query point."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dspline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glmgen/dspline/tree/main/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Discrete integration</h1>
      <small class="dont-index">Source: <a href="https://github.com/glmgen/dspline/blob/main/R/discrete_calculus.R" class="external-link"><code>R/discrete_calculus.R</code></a></small>
      <div class="d-none name"><code>discrete_integ.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the discrete integral of a function (or vector of function
evaluations) of a given order, with respect to given design points, and
evaluated at a given query point.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">discrete_integ</span><span class="op">(</span><span class="va">f</span>, <span class="va">k</span>, <span class="va">xd</span>, <span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>Function, or vector of function evaluations at <code>c(xd, x)</code>, the
design points <code>xd</code> adjoined with the query point(s) <code>x</code>.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Order for the discrete integral calculation. Must be &gt;= 0.</p></dd>


<dt id="arg-xd">xd<a class="anchor" aria-label="anchor" href="#arg-xd"></a></dt>
<dd><p>Design points. Must be sorted in increasing order, and have length
at least <code>k+1</code>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Query point(s).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Discrete integral of <code>f</code> of order <code>k</code>, with respect to design points
<code>xd</code>, evaluated at the query point(s) <code>x</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The discrete integral operator of order \(k\), with respect to
design points \(x_1 &lt; \ldots &lt; x_n\), is denoted \(S^k_n\). It is the
inverse operator to the discrete derivative operator \(\Delta^k_n\), so
that:
$$
  S^k_n \Delta^k_n = \Delta^k_n S^k_n = \mathrm{Id},
  $$ where
\(\mathrm{Id}\) denotes the identity operator. It can also be represented
in a more explicit form, as follows. Acting on a function \(f\) of order
\(k\), and evaluated at a query point \(x\), it yields:
$$
  (S^k_n f)(x) =
  \begin{cases}
  \displaystyle
  \sum_{j=1}^k h^{k-1}_j(x) \cdot f(x_j) +
  \sum_{j=k+1}^i h^{k-1}_j(x) \cdot \frac{x_j-x_{j-k}}{k} \cdot f(x_j)
  + h^{k-1}_{i+1}(x) \cdot \frac{x-x_{i-k+1}}{k} \cdot f(x) &amp; \\
  &amp; \hspace{-75pt} \text{if $x \in (x_i,x_{i+1}]$, $i \geq k$} \\
  \displaystyle
  \sum_{j=1}^i h^{k-1}_j(x) \cdot f(x_j) \,+\, h^{k-1}_{i+1}(x) \cdot f(x)
  &amp; \hspace{-75pt} \text{if $x \in (x_i,x_{i+1}]$, $i &lt;  k$} \\
  f(x) &amp; \hspace{-75pt} \text{if $x \leq x_1$},
  \end{cases}
  $$
where \(h^{k-1}_1, \ldots, h^{k-1}_n\) denote the falling factorial basis
functions of degree \(k-1\), with knots in \(x_{k:(n-1)}\). The help
file for <code><a href="h_mat.html">h_mat()</a></code> gives a definition of the falling factorial basis. It
can be seen (due to the one-sided support of the falling factorial basis
functions) that discrete integration at \(x = x_i\), \(i = 1,\ldots,n\)
is equivalent to multiplication by a weighted version of the falling
factorial basis matrix. For more details, including an alternative
recursive representation for discrete integration (that elucidates its
relationship to discrete differentiation), see Section 3.2 of Tibshirani
(2020).</p>
<p><strong>Note:</strong> for calculating discrete integrals at the design points themselves,
which could be achieved by taking <code>x = xd</code> in the current function, one
should instead use <code><a href="h_mat_mult.html">h_mat_mult()</a></code> with <code>di_weighting = TRUE</code>, as this will
be <strong>much</strong> more efficient (quadratic-time versus linear-time).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Tibshirani (2020), "Divided differences, falling factorials, and
discrete splines: Another look at trend filtering and related problems",
Section 3.2.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="h_mat_mult.html">h_mat_mult()</a></code> for multiplication by the falling factorial basis
matrix, giving a weighted analog of discrete integration at the design
points.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">xd</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> <span class="op">/</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="fu">discrete_integ</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span>, <span class="fl">1</span>, <span class="va">xd</span>, <span class="va">xd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 1.0 1.1 1.2 1.3 1.4 1.5 1.6 1.7 1.8 1.9</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Addison Hu, Ryan Tibshirani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

