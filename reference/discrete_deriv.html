<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Discrete differentiation — discrete_deriv • dspline</title><!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Discrete differentiation — discrete_deriv"><meta name="description" content="Computes the discrete derivative of a function (or vector of function
evaluations) of a given order, with respect to given design points, and
evaluated at a given query point."><meta property="og:description" content="Computes the discrete derivative of a function (or vector of function
evaluations) of a given order, with respect to given design points, and
evaluated at a given query point."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dspline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glmgen/dspline/tree/main/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Discrete differentiation</h1>
      <small class="dont-index">Source: <a href="https://github.com/glmgen/dspline/blob/main/R/discrete_calculus.R" class="external-link"><code>R/discrete_calculus.R</code></a></small>
      <div class="d-none name"><code>discrete_deriv.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Computes the discrete derivative of a function (or vector of function
evaluations) of a given order, with respect to given design points, and
evaluated at a given query point.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">discrete_deriv</span><span class="op">(</span><span class="va">f</span>, <span class="va">k</span>, <span class="va">xd</span>, <span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-f">f<a class="anchor" aria-label="anchor" href="#arg-f"></a></dt>
<dd><p>Function, or vector of function evaluations at <code>c(xd, x)</code>, the
design points <code>xd</code> adjoined with the query point(s) <code>x</code>.</p></dd>


<dt id="arg-k">k<a class="anchor" aria-label="anchor" href="#arg-k"></a></dt>
<dd><p>Order for the discrete derivative calculation. Must be &gt;= 0.</p></dd>


<dt id="arg-xd">xd<a class="anchor" aria-label="anchor" href="#arg-xd"></a></dt>
<dd><p>Design points. Must be sorted in increasing order, and have length
at least <code>k+1</code>.</p></dd>


<dt id="arg-x">x<a class="anchor" aria-label="anchor" href="#arg-x"></a></dt>
<dd><p>Query point(s).</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Discrete derivative of <code>f</code> of order <code>k</code>, with respect to design
points <code>xd</code>, evaluated at the query point(s) <code>x</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The discrete derivative operator of order \(k\), with respect
design points \(x_1 &lt; \ldots &lt; x_n\), is denoted \(\Delta^k_n\). Acting
on a function \(f\), and evaluated at a query point \(x\), it yields:
$$
  (\Delta^k_n f) (x) =
  \begin{cases}
  k! \cdot f[x_{i-k+1},\ldots,x_i,x] &amp; \text{if $x \in (x_i,x_{i+1}]$, $i
  \geq k$} \\
  i! \cdot f[x_1,\ldots,x_i,x] &amp; \text{if $x \in (x_i,x_{i+1}]$, $i &lt; k$} \\
  f(x) &amp; \text{if $x \leq x_1$},
  \end{cases}
  $$
where we take \(x_{n+1} = \infty\) for convenience. In other words, for
"most" points \(x &gt; x_k\), we define \((\Delta^k_n f)(x)\) in terms of
a (scaled) divided difference of \(f\) of order \(k\), where the
centers are the \(k\) points immediately to the left of \(x\), and
\(x\) itself. Meanwhile, for "boundary" points \(x \leq x_k\), we
define \((\Delta^k_n f)(x)\) to be a (scaled) divided difference of
\(f\) of the highest possible order, where the centers are the points to
the left of \(x\), and \(x\) itself. For more discussion, including
alternative representations for the discrete differentiation, see Section
3.1 of Tibshirani (2020).</p>
<p><strong>Note:</strong> for calculating discrete derivatives at the design points
themselves, which could be achieved by taking <code>x = xd</code> in the current
function, one should instead use <code><a href="b_mat_mult.html">b_mat_mult()</a></code> or <code><a href="d_mat_mult.html">d_mat_mult()</a></code>, as these
will be more efficient (both will be linear-time, but the latter functions
will be faster).</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Tibshirani (2020), "Divided differences, falling factorials, and
discrete splines: Another look at trend filtering and related problems",
Section 3.1.</p>
    </div>
    <div class="section level2">
    <h2 id="see-also">See also<a class="anchor" aria-label="anchor" href="#see-also"></a></h2>
    <div class="dont-index"><p><code><a href="b_mat_mult.html">b_mat_mult()</a></code>, <code><a href="d_mat_mult.html">d_mat_mult()</a></code> for multiplication by the extended
and non-extended discrete derivative matrices, giving discrete derivatives
at design points.</p></div>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="va">xd</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">10</span> <span class="op">/</span> <span class="fl">10</span></span></span>
<span class="r-in"><span><span class="fu">discrete_deriv</span><span class="op">(</span><span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="va">x</span><span class="op">^</span><span class="fl">2</span>, <span class="fl">1</span>, <span class="va">xd</span>, <span class="va">xd</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>  [1] 0.01 0.30 0.50 0.70 0.90 1.10 1.30 1.50 1.70 1.90</span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Addison Hu, Ryan Tibshirani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

