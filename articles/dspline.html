<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Introduction to dspline • dspline</title>
<!-- katex math --><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.css" integrity="sha384-nB0miv6/jRmo5UMMR1wu3Gz6NLsoTkbqJghGIsx//Rlm+ZU03BU6SQNC66uf4l5+" crossorigin="anonymous">
<script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/katex.min.js" integrity="sha384-7zkQWkzuo3B5mTepMUcHkMB5jZaolc2xDwL6VFqjFALcbeS9Ggm/Yr2r3Dy4lfFg" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.11/dist/contrib/auto-render.min.js" integrity="sha384-43gviWU0YVjaDtb/GhzOouOXtZMP/7XUzwPTstBeZFe/+rCMvRwr4yROQP43s0Xk" crossorigin="anonymous" onload="renderMathInElement(document.body);"></script><script src="../katex-auto.js"></script><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Introduction to dspline">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">dspline</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.0.2.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="active nav-item"><a class="nav-link" href="../articles/dspline.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/glmgen/dspline/tree/main/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Introduction to dspline</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/glmgen/dspline/blob/main/vignettes/dspline.Rmd" class="external-link"><code>vignettes/dspline.Rmd</code></a></small>
      <div class="d-none name"><code>dspline.Rmd</code></div>
    </div>

    
    
<div class="section level2">
<h2 id="overview">Overview<a class="anchor" aria-label="anchor" href="#overview"></a>
</h2>
<p>This vignette provides a brief introduction to the
<code>dspline</code> package. We’ll do the following:</p>
<ul>
<li>compute discrete derivatives;</li>
<li>smooth by regression onto the space of discrete splines;</li>
<li>perform interpolation in the space of discrete splines;</li>
<li>check that a discrete spline’s discrete derivatives match its
derivatives.</li>
</ul>
<p>We’ll load the package before diving in to these sections.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/glmgen/dspline" class="external-link">dspline</a></span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="computing-discrete-derivatives">Computing discrete derivatives<a class="anchor" aria-label="anchor" href="#computing-discrete-derivatives"></a>
</h2>
<p>Let’s begin with a test function.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">expr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/expression.html" class="external-link">expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="va">x</span> <span class="op">*</span> <span class="op">(</span><span class="fl">1</span> <span class="op">+</span> <span class="va">x</span><span class="op">)</span> <span class="op">*</span> <span class="fl">7</span> <span class="op">*</span> <span class="va">pi</span> <span class="op">/</span> <span class="fl">2</span><span class="op">)</span> <span class="op">+</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">4</span> <span class="op">*</span> <span class="op">(</span><span class="va">x</span> <span class="op">-</span> <span class="fl">0.5</span><span class="op">)</span><span class="op">^</span><span class="fl">2</span><span class="op">)</span> <span class="op">*</span> <span class="fl">4</span><span class="op">)</span></span>
<span><span class="va">f</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="va">expr</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/curve.html" class="external-link">curve</a></span><span class="op">(</span><span class="va">f</span>, n <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span></code></pre></div>
<p><img src="dspline_files/figure-html/unnamed-chunk-4-1.png" width="2187.5"></p>
<p>As usual, we can compute derivatives using <code><a href="https://rdrr.io/r/stats/deriv.html" class="external-link">D()</a></code>. Below,
we show how to compute its discrete derivatives based on evaluating
<code>f</code> at 100 design points <code>xd</code>, and multiplying
these evaluations the discrete difference operator defined over the
design points. This is done using the function [d_mat_mult()]. We’ll
demonstrate this with both first and second derivatives.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">n</span> <span class="op">=</span> <span class="fl">100</span></span>
<span><span class="va">xd</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="va">n</span> <span class="op">/</span> <span class="op">(</span><span class="va">n</span><span class="op">+</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># First derivatives</span></span>
<span><span class="va">fd</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html" class="external-link">D</a></span><span class="op">(</span><span class="va">expr</span>, <span class="st">"x"</span><span class="op">)</span></span>
<span><span class="va">u1</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="va">fd</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">vhat1</span> <span class="op">=</span> <span class="fu"><a href="../reference/d_mat_mult.html">d_mat_mult</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">xd</span><span class="op">)</span>, <span class="fl">1</span>, <span class="va">xd</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">u1</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylab <span class="op">=</span> <span class="st">"First derivative"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">xd</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">n</span><span class="op">]</span>, <span class="va">vhat1</span>, col <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"o"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">21</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>,</span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Exact"</span>, <span class="st">"Discrete"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">xd</span><span class="op">)</span></span></code></pre></div>
<p><img src="dspline_files/figure-html/unnamed-chunk-5-1.png" width="2187.5"></p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Second derivatives</span></span>
<span><span class="va">fd2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html" class="external-link">D</a></span><span class="op">(</span><span class="va">fd</span>, <span class="st">"x"</span><span class="op">)</span></span>
<span><span class="va">u2</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="va">fd2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">v2</span> <span class="op">=</span> <span class="fu"><a href="../reference/d_mat_mult.html">d_mat_mult</a></span><span class="op">(</span><span class="fu">f</span><span class="op">(</span><span class="va">xd</span><span class="op">)</span>, <span class="fl">2</span>, <span class="va">xd</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">u2</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylab <span class="op">=</span> <span class="st">"Second derivative"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">xd</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="va">n</span><span class="op">]</span>, <span class="va">v2</span>, col <span class="op">=</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"o"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Exact"</span>, <span class="st">"Discrete"</span><span class="op">)</span>,</span>
<span>       lty <span class="op">=</span> <span class="fl">1</span>, pch <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fl">21</span><span class="op">)</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">xd</span><span class="op">)</span></span></code></pre></div>
<p><img src="dspline_files/figure-html/unnamed-chunk-5-2.png" width="2187.5"></p>
<p>Note that the discrete derivatives come back as a vector of length
<code>n-k-1</code>, with <code>n</code> being the number of design
points and <code>k</code> being the derivative order. Each discrete
derivative here is left-aligned, meaning that the <code>k</code>th
derivative at a given point <code>x</code> uses the evaluation of
<code>f</code> at <code>x</code> and <code>k</code> design points to the
left of <code>x</code>. Thus we associate the <code>n-k-1</code>
discrete derivatives with the design points numbered <code>k+1</code>
through <code>n</code>. (The design points <code>xd</code> here are
taken to be evenly-spaced, but this is not fundamental, and the design
points could instead be at arbitrary locations.)</p>
<p>As an alternative to [d_mat_mult()], we could form the difference
operator (as a sparse matrix) using [d_mat()], and then do the matrix
multiplication manually, but using [d_mat_mult()] is more efficient. It
doesn’t actually form any such matrix internally, and instead performs a
specialized routine to carry out the discrete derivative
computations.</p>
</div>
<div class="section level2">
<h2 id="discrete-spline-smoothing">Discrete spline smoothing<a class="anchor" aria-label="anchor" href="#discrete-spline-smoothing"></a>
</h2>
<p>Now we’ll smooth some noisy data, by regressing it onto the space of
discrete splines of cubic degree, with 9 knots which are roughly
evenly-spaced among the design points. This is done using the function
[dspline_solve()].</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">y</span> <span class="op">=</span> <span class="fu">f</span><span class="op">(</span><span class="va">xd</span><span class="op">)</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="va">n</span>, sd <span class="op">=</span> <span class="fl">0.5</span><span class="op">)</span></span>
<span></span>
<span><span class="va">knot_idx</span> <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">9</span> <span class="op">*</span> <span class="fl">10</span> </span>
<span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/dspline_solve.html">dspline_solve</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">3</span>, <span class="va">xd</span>, <span class="va">knot_idx</span><span class="op">)</span></span>
<span><span class="va">yhat</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">fit</span> <span class="co"># Fitted values from the regression of y onto discrete splines</span></span>
<span><span class="va">N</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">mat</span> <span class="co"># Discrete B-spline basis, for visualization purposes only!</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xd</span>, <span class="va">y</span>, xlab <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">xd</span>, <span class="va">yhat</span>, col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">xd</span>, <span class="va">N</span> <span class="op">*</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">xd</span><span class="op">)</span></span></code></pre></div>
<p><img src="dspline_files/figure-html/unnamed-chunk-6-1.png" width="2187.5"></p>
<p>As we can see, the fitted values from the regression onto the space
of discrete splines do a qualitatively reasonable job of smoothing. The
basis functions used here (i.e., covariates in the regression) are
called discrete B-splines, and are the default choice (corresponding to
<code>basis = "N"</code>) in [dspline_solve()]. These have compact
support, just like the usual B-spline basis. While other bases are
available, for regression problems in which the knot points are a sparse
subset of the design points, the discrete B-spline basis is likely the
best choice in terms of efficiency and numerical stability. The
computational cost is linear in the number of knots. For more details,
see Section 8.1 of <a href="https://www.stat.berkeley.edu/~ryantibs/papers/dspline.pdf" class="external-link">Tibshirani
(2020)</a>.</p>
<div class="section level3">
<h3 id="relation-to-trend-filtering">Relation to trend filtering<a class="anchor" aria-label="anchor" href="#relation-to-trend-filtering"></a>
</h3>
<p>The smoothing above is done using ordinary least squares regression,
with fixed knots and without regularization. A related and more advanced
technique would be to use trend filtering, which places a knot at each
eligible design point (rather than fixing the knots ahead of time) and
performs a regularized regression onto the space of discrete splines, by
penalizing the <span class="math inline">\ell_1</span> norm of discrete
derivatives across the design points. This has the advantage of being
more locally adaptive: allocating more flexibility to the fitted
function dynamically, at parts of the input space in which such
flexibility is warranted, rather than letting this be dictated by a
given fixed knot sequence. To learn more, see the <a href="https://github.com/glmgen/trendfilter" class="external-link">trendfilter</a> package, or
<a href="https://www.stat.berkeley.edu/~ryantibs/papers/trendfilter.pdf" class="external-link">Tibshirani
(2014)</a> or Sections 1 and 2.5 of <a href="https://www.stat.berkeley.edu/~ryantibs/papers/dspline.pdf" class="external-link">Tibshirani
(2020)</a>.</p>
</div>
</div>
<div class="section level2">
<h2 id="discrete-spline-interpolation">Discrete spline interpolation<a class="anchor" aria-label="anchor" href="#discrete-spline-interpolation"></a>
</h2>
<p>To go from a sequence of fitted values to a fitted function, we must
interpolate in the space of cubic discrete splines. We’ll do this using
[dspline_interp()].</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html" class="external-link">seq</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">1</span>, length <span class="op">=</span> <span class="fl">1000</span><span class="op">)</span></span>
<span><span class="va">fhat</span> <span class="op">=</span> <span class="fu"><a href="../reference/dspline_interp.html">dspline_interp</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="fl">3</span>, <span class="va">xd</span>, <span class="va">x</span>, implicit <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xd</span>, <span class="va">y</span>, xlab <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fhat</span>, col <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">xd</span>, <span class="va">N</span> <span class="op">*</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">xd</span><span class="op">[</span><span class="va">knot_idx</span><span class="op">]</span>, col <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">xd</span><span class="op">)</span></span></code></pre></div>
<p><img src="dspline_files/figure-html/unnamed-chunk-7-1.png" width="2187.5"></p>
<p>The function plotted in as a thick red line above is a bona fide
cubic discrete spline: it is a piecewise cubic polynomial with knots at
the specified points (marked as vertical gray lines), and its discrete
derivatives of orders 1 and 2 are all continuous at the knots. This
visualized below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">dd1</span> <span class="op">=</span> <span class="fu"><a href="../reference/d_mat_mult.html">d_mat_mult</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="fl">1</span>, <span class="va">xd</span><span class="op">)</span></span>
<span><span class="va">dd2</span> <span class="op">=</span> <span class="fu"><a href="../reference/d_mat_mult.html">d_mat_mult</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="fl">2</span>, <span class="va">xd</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xd</span><span class="op">[</span><span class="fl">2</span><span class="op">:</span><span class="va">n</span><span class="op">]</span>, <span class="va">dd1</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"First discrete derivative"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">xd</span><span class="op">[</span><span class="va">knot_idx</span><span class="op">]</span>, col <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">xd</span><span class="op">)</span></span></code></pre></div>
<p><img src="dspline_files/figure-html/unnamed-chunk-8-1.png" width="2187.5"></p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xd</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="va">n</span><span class="op">]</span>, <span class="va">dd2</span>, xlab <span class="op">=</span> <span class="st">"x"</span>, ylab <span class="op">=</span> <span class="st">"Second discrete derivative"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">xd</span><span class="op">[</span><span class="va">knot_idx</span><span class="op">]</span>, col <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">xd</span><span class="op">)</span></span></code></pre></div>
<p><img src="dspline_files/figure-html/unnamed-chunk-8-2.png" width="2187.5"></p>
</div>
<div class="section level2">
<h2 id="matching-derivatives">Matching derivatives<a class="anchor" aria-label="anchor" href="#matching-derivatives"></a>
</h2>
<p>What about the discrete derivatives of order 3? Being a cubic
discrete spline<br>
(piecewise cubic polynomial), these are, unsurprisingly, piecewise
constant.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">inds</span> <span class="op">=</span> <span class="va">x</span> <span class="op">&gt;</span> <span class="fl">0.05</span> <span class="co"># Exclude points near left boundary</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">inds</span><span class="op">]</span></span>
<span><span class="va">fhat</span> <span class="op">=</span> <span class="va">fhat</span><span class="op">[</span><span class="va">inds</span><span class="op">]</span></span>
<span><span class="va">dd3</span> <span class="op">=</span> <span class="fu"><a href="../reference/discrete_deriv.html">discrete_deriv</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">yhat</span>, <span class="va">fhat</span><span class="op">)</span>, <span class="fl">3</span>, <span class="va">xd</span>, <span class="va">x</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">dd3</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylab <span class="op">=</span> <span class="st">"Third discrete derivative"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">xd</span><span class="op">[</span><span class="va">knot_idx</span><span class="op">]</span>, col <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">xd</span><span class="op">[</span><span class="va">xd</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="dspline_files/figure-html/unnamed-chunk-9-1.png" width="2187.5"></p>
<p>Here we used [discrete_deriv()] to compute the discrete derivatives
over a fine grid of locations <code>x</code> outside of the design
points <code>xd</code>. (Note: as used earlier, the function
[d_mat_mult()] is a convenient way to compute discrete derivatives at
the design points <code>xd</code> themselves.)</p>
<p>A special property of a <code>k</code>th degree discrete spline is
that their <code>k</code>th degree discrete derivatives match their
<code>k</code>th derivatives, everywhere in the domain. To check this,
we’ll need to first compute an analytic representation for the discrete
cubic spline interpolant underlying <code>fhat</code>, and then
differentiate it using <code><a href="https://rdrr.io/r/stats/deriv.html" class="external-link">D()</a></code>. For this analytic
representation, it is most convenient to use the falling factorial
(rather than discrete B-spline) basis.</p>
<p><em>Warning: what happens below to compute and evaluate symbolic
derivatives of the analytic representation gets a bit hairy!
Importantly, you’ll never have to do this in order to use the
<code>dspline</code> package. It’s only done for the purpose of
verifying the claim that the discrete derivatives match the usual
derivatives.</em></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">res</span> <span class="op">=</span> <span class="fu"><a href="../reference/dspline_solve.html">dspline_solve</a></span><span class="op">(</span><span class="va">y</span>, <span class="fl">3</span>, <span class="va">xd</span>, <span class="va">knot_idx</span>, basis <span class="op">=</span> <span class="st">"H"</span><span class="op">)</span></span>
<span><span class="va">yhat</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">fit</span> <span class="co"># Fitted values from the regression of y onto discrete splines</span></span>
<span><span class="va">H</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">mat</span> <span class="co"># Falling factorial basis, for visualization purposes only!</span></span>
<span><span class="va">sol</span> <span class="op">=</span> <span class="va">res</span><span class="op">$</span><span class="va">sol</span> <span class="co"># Falling factorial basis coefficients, for expansion later</span></span>
<span></span>
<span><span class="co"># Sanity check: the fitted values from H (instead of N) should look as before </span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xd</span>, <span class="va">y</span>, xlab <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/points.html" class="external-link">points</a></span><span class="op">(</span><span class="va">xd</span>, <span class="va">yhat</span>, col <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">19</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">xd</span>, <span class="va">H</span> <span class="op">*</span> <span class="fl">80</span>, type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">xd</span><span class="op">)</span></span></code></pre></div>
<p><img src="dspline_files/figure-html/unnamed-chunk-10-1.png" width="2187.5"></p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Now build analytic expansion in terms of falling factorial bases functions.</span></span>
<span><span class="co"># Unfortunately we need to separate out the terms involving inequalities, since</span></span>
<span><span class="co"># D() can't properly (symbolically) differentiate through inequalities, so this</span></span>
<span><span class="co"># ends up being more complicated than it should be ...</span></span>
<span><span class="va">poly_terms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%f"</span>, <span class="va">sol</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="va">ineq_terms</span> <span class="op">=</span> <span class="st">"1"</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">j</span> <span class="kw">in</span> <span class="fl">2</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">sol</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">j</span> <span class="op">&lt;=</span> <span class="fl">4</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">x_prod</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(x - %f)"</span>, <span class="va">xd</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="op">(</span><span class="va">j</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">]</span><span class="op">)</span>, </span>
<span>      collapse <span class="op">=</span> <span class="st">" * "</span><span class="op">)</span></span>
<span>    <span class="va">poly_terms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="va">poly_terms</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%f * %s / factorial(%i)"</span>, <span class="va">sol</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">x_prod</span>, <span class="va">j</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ineq_terms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="va">ineq_terms</span>, <span class="st">"1"</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">x_prod</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(x - %f)"</span>, <span class="va">xd</span><span class="op">[</span><span class="va">knot_idx</span><span class="op">[</span><span class="va">j</span><span class="op">-</span><span class="fl">4</span><span class="op">]</span> <span class="op">-</span> <span class="fl">2</span><span class="op">:</span><span class="fl">0</span><span class="op">]</span><span class="op">)</span>, </span>
<span>      collapse <span class="op">=</span> <span class="st">" * "</span><span class="op">)</span></span>
<span>    <span class="va">poly_terms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="va">poly_terms</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"%f * %s / factorial(3)"</span>, <span class="va">sol</span><span class="op">[</span><span class="va">j</span><span class="op">]</span>, <span class="va">x_prod</span><span class="op">)</span><span class="op">)</span></span>
<span>    <span class="va">ineq_terms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span></span>
<span>      <span class="va">ineq_terms</span>, </span>
<span>      <span class="fu"><a href="https://rdrr.io/r/base/sprintf.html" class="external-link">sprintf</a></span><span class="op">(</span><span class="st">"(x &gt; %f)"</span>, <span class="va">xd</span><span class="op">[</span><span class="va">knot_idx</span><span class="op">[</span><span class="va">j</span><span class="op">-</span><span class="fl">4</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Sanity check: the interpolant from this expression should look as before </span></span>
<span><span class="va">combined_terms</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">poly_terms</span>, <span class="va">ineq_terms</span>, sep <span class="op">=</span> <span class="st">" * "</span><span class="op">)</span>,</span>
<span>  collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span></span>
<span><span class="va">fhat</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">str2expression</a></span><span class="op">(</span><span class="va">combined_terms</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">xd</span>, <span class="va">y</span>, xlab <span class="op">=</span> <span class="st">"x"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">fhat</span>, col <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/matplot.html" class="external-link">matplot</a></span><span class="op">(</span><span class="va">xd</span>, <span class="va">N</span> <span class="op">*</span> <span class="fl">2</span>, type <span class="op">=</span> <span class="st">"l"</span>, lty <span class="op">=</span> <span class="fl">1</span>, add <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">xd</span><span class="op">[</span><span class="va">knot_idx</span><span class="op">]</span>, col <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">xd</span><span class="op">)</span></span></code></pre></div>
<p><img src="dspline_files/figure-html/unnamed-chunk-10-2.png" width="2187.5"></p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># Higher-order symbolic derivative function (from help file for D())</span></span>
<span><span class="va">DD</span> <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">expr</span>, <span class="va">name</span>, <span class="va">order</span> <span class="op">=</span> <span class="fl">1</span><span class="op">)</span> <span class="op">{</span></span>
<span>   <span class="kw">if</span><span class="op">(</span><span class="va">order</span> <span class="op">==</span> <span class="fl">1</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/stats/deriv.html" class="external-link">D</a></span><span class="op">(</span><span class="va">expr</span>, <span class="va">name</span><span class="op">)</span></span>
<span>   <span class="kw">else</span> <span class="fu">DD</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/deriv.html" class="external-link">D</a></span><span class="op">(</span><span class="va">expr</span>, <span class="va">name</span><span class="op">)</span>, <span class="va">name</span>, <span class="va">order</span> <span class="op">-</span> <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># Finally, compute third derivatives of falling factorial basis expansion</span></span>
<span><span class="va">d3</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">numeric</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="kw">if</span> <span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;=</span> <span class="va">xd</span><span class="op">[</span><span class="va">knot_idx</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span><span class="op">)</span> <span class="op">{</span></span>
<span>    <span class="va">expr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">str2expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">poly_terms</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">4</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">j</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">max</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/which.html" class="external-link">which</a></span><span class="op">(</span><span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&gt;</span> <span class="va">xd</span><span class="op">[</span><span class="va">knot_idx</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">4</span></span>
<span>    <span class="va">expr</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/parse.html" class="external-link">str2expression</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="va">poly_terms</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="va">j</span><span class="op">]</span>, collapse <span class="op">=</span> <span class="st">" + "</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="va">d3</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/eval.html" class="external-link">eval</a></span><span class="op">(</span><span class="fu">DD</span><span class="op">(</span><span class="va">expr</span>, <span class="st">"x"</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">x</span><span class="op">[</span><span class="va">i</span><span class="op">]</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">d3</span>, type <span class="op">=</span> <span class="st">"l"</span>, ylab <span class="op">=</span> <span class="st">"Third derivative"</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">dd3</span>, col <span class="op">=</span> <span class="fl">2</span>, lty <span class="op">=</span> <span class="fl">2</span>, lwd <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/abline.html" class="external-link">abline</a></span><span class="op">(</span>v <span class="op">=</span> <span class="va">xd</span><span class="op">[</span><span class="va">knot_idx</span><span class="op">]</span>, col <span class="op">=</span> <span class="fl">8</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/legend.html" class="external-link">legend</a></span><span class="op">(</span><span class="st">"bottomleft"</span>, lty <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, col <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">2</span>, </span>
<span>       legend <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Exact"</span>, <span class="st">"Discrete"</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/rug.html" class="external-link">rug</a></span><span class="op">(</span><span class="va">xd</span><span class="op">[</span><span class="va">xd</span> <span class="op">&gt;</span> <span class="fu"><a href="https://rdrr.io/r/base/Extremes.html" class="external-link">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">]</span><span class="op">)</span></span></code></pre></div>
<p><img src="dspline_files/figure-html/unnamed-chunk-10-3.png" width="2187.5"></p>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Addison Hu, Ryan Tibshirani.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
