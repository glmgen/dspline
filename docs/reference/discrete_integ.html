<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Discrete integration — discrete_integ • dspline</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Discrete integration — discrete_integ"><meta property="og:description" content="Computes the discrete integral of a function (or vector of function
evaluations) of a given order, with respect to given design points, and
evaluated at a given query point."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dspline</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/ryantibs/dspline/tree/main/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Discrete integration</h1>
    <small class="dont-index">Source: <a href="https://github.com/ryantibs/dspline/blob/main/R/discrete_calculus.R" class="external-link"><code>R/discrete_calculus.R</code></a></small>
    <div class="hidden name"><code>discrete_integ.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes the discrete integral of a function (or vector of function
evaluations) of a given order, with respect to given design points, and
evaluated at a given query point.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">discrete_integ</span><span class="op">(</span><span class="va">f</span>, <span class="va">k</span>, <span class="va">xd</span>, <span class="va">x</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>f</dt>
<dd><p>Function, or vector of function evaluations at <code>c(xd, x)</code>, the
design points <code>xd</code> adjoined with the query point(s) <code>x</code>.</p></dd>


<dt>k</dt>
<dd><p>Order for the discrete integral calculation. Must be &gt;= 0.</p></dd>


<dt>xd</dt>
<dd><p>Design points. Must be sorted in increasing order, and have length
at least <code>k+1</code>.</p></dd>


<dt>x</dt>
<dd><p>Query point(s).</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Discrete integral of <code>f</code> of order <code>k</code>, with respect to design points
<code>xd</code>, evaluated at the query point(s) <code>x</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The discrete integral operator of order \(k\), with respect to
design points \(x_1 &lt; \ldots &lt; x_n\), is denoted \(S^k_n\). It is the
inverse operator to the discrete derivative operator \(\Delta^k_n\), so
that:
$$
  S^k_n \Delta^k_n = \Delta^k_n S^k_n = \mathrm{Id},
  $$ where
\(\mathrm{Id}\) denotes the identity operator. It can also be represented
in a more explicit form, as follows. Acting on a function \(f\) of order
\(k\), and evaluated at a query point \(x\), it yields:
$$
  (S^k_n f)(x) = 
  \begin{cases}
  \displaystyle
  \sum_{j=1}^k h^{k-1}_j(x) \cdot f(x_j) +
  \sum_{j=k+1}^i h^{k-1}_j(x) \cdot \frac{x_j-x_{j-k}}{k} \cdot f(x_j) 
  + h^{k-1}_{i+1}(x) \cdot \frac{x-x_{i-k+1}}{k} \cdot f(x) &amp; \\
  &amp; \hspace{-75pt} \text{if $x \in (x_i,x_{i+1}]$, $i \geq k$} \\ 
  \displaystyle
  \sum_{j=1}^i h^{k-1}_j(x) \cdot f(x_j) \,+\, h^{k-1}_{i+1}(x) \cdot f(x) 
  &amp; \hspace{-75pt} \text{if $x \in (x_i,x_{i+1}]$, $i &lt;  k$} \\
  f(x) &amp; \hspace{-75pt} \text{if $x \leq x_1$},
  \end{cases}
  $$
where \(h^{k-1}_1, \ldots, h^{k-1}_n\) denote the falling factorial basis
functions of degree \(k-1\), with knots in \(x_{k:(n-1)}\). The help
file for <code><a href="h_mat.html">h_mat()</a></code> gives a definition of the falling factorial basis. It
can be seen (due to the one-sided support of the falling factorial basis
functions) that discrete integration at \(x = x_i\), \(i = 1,\ldots,n\)
is equivalent to multiplication by a weighted version of the falling
factorial basis matrix. For more details, including an alternative
recursive representation for discrete integration (that elucidates its
relationship to discrete differentiation), see Section 3.2 of Tibshirani
(2020).</p>
<p><strong>Note:</strong> for calculating discrete integrals at the design points themselves,
which could be achieved by taking <code>x = xd</code> in the current function, one
should instead use <code><a href="h_mat_mult.html">h_mat_mult()</a></code> with <code>di_weighting = TRUE</code>, as this will
be <strong>much</strong> more efficient (quadratic-time versus linear-time).</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Tibshirani (2020), "Divided differences, falling factorials, and
discrete splines: Another look at trend filtering and related problems",
Section 3.2.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="h_mat_mult.html">h_mat_mult()</a></code> for multiplication by the falling factorial basis
matrix, giving a weighted analog of discrete integration at the design
points.</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Addison Hu, Ryan Tibshirani.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

