<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Multiply by H matrix — h_mat_mult • dspline</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Multiply by H matrix — h_mat_mult"><meta property="og:description" content="Multiplies a given vector by H, the falling factorial basis matrix of a given
order, with respect to given design points."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">
    

    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dspline</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/glmgen/dspline/tree/main/" class="external-link">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Multiply by H matrix</h1>
    <small class="dont-index">Source: <a href="https://github.com/glmgen/dspline/blob/main/R/matrix_multiplication.R" class="external-link"><code>R/matrix_multiplication.R</code></a></small>
    <div class="hidden name"><code>h_mat_mult.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Multiplies a given vector by H, the falling factorial basis matrix of a given
order, with respect to given design points.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">h_mat_mult</span><span class="op">(</span><span class="va">v</span>, <span class="va">k</span>, <span class="va">xd</span>, di_weighting <span class="op">=</span> <span class="cn">FALSE</span>, transpose <span class="op">=</span> <span class="cn">FALSE</span>, inverse <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>
    <dl><dt>v</dt>
<dd><p>Vector to be multiplied by H, the falling factorial basis matrix.</p></dd>


<dt>k</dt>
<dd><p>Order for the falling factorial basis matrix. Must be &gt;= 0.</p></dd>


<dt>xd</dt>
<dd><p>Design points. Must be sorted in increasing order, and have length
at least <code>k+1</code>.</p></dd>


<dt>di_weighting</dt>
<dd><p>Should "discrete integration weighting" be used?
Multiplication by such a weighted H gives discrete integrals at the
design points; see details for more information. The default is <code>FALSE</code>.</p></dd>


<dt>transpose</dt>
<dd><p>Multiply by the transpose of H? The default is <code>FALSE</code>.</p></dd>


<dt>inverse</dt>
<dd><p>Multiply by the inverse of H? The default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    

<p>Product of falling factorial basis matrix H and the input vector <code>v</code>.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The falling factorial basis matrix of order \(k\), with respect to
design points \(x_1 &lt; \ldots &lt; x_n\), is denoted \(H^k_n\). Its entries
are defined as:
$$
  (H^k_n)_{ij} = h^k_j(x_i),
  $$
where \(h^k_j\) is the \(j\)th falling factorial basis function, as
defined in the help file for <code><a href="h_mat.html">h_mat()</a></code>. The matrix \(H^k_n\) can be
constructed recursively as the product of \(H^{k-1}_n\) and a
diagonally-weighted cumulative sum matrix; see the help file for <code><a href="h_mat.html">h_mat()</a></code>,
or Section 6.3 of Tibshirani (2020). Therefore, multiplication by
\(H^k_n\) or by its transpose can be performed in \(O(nk)\) operations
based on iterated weighted cumulative sums. See Appendix D of Tibshirani
(2020) for details.</p>
<p>The option <code>di_weighting = TRUE</code> performs multiplication by \(H^k_n
  Z^{k+1}_n\) where \(Z^{k+1}_n\) is an \(n \times n\) diagonal matrix
whose first \(k+1\) diagonal entries of \(Z^{k+1}_n\) are 1 and last
\(n-k-1\) diagonal entries are \((x_{i+k+1} - x_i) / (k+1)\), \(i =
  1,\ldots,n-k-1\). The connection to discrete integration is as follows:
multiplication of \(v = f(x_{1:n})\) by \(H^k_n Z^{k+1}_n\) gives order
\(k+1\) discrete integrals (note the increment in order of integration
here) of \(f\) at the points \(x_{1:n}\):
$$
  H^k_n Z^{k+1}_n v = (S^{k+1}_n f)(x_{1:n}). 
  $$</p>
<p>Lastly, the matrix \(H^k_n\) has a special <strong>inverse relationship</strong> to the
extended discrete derivative matrix \(B^{k+1}_n\) of degree \(k+1\); it
satisfies:
$$
  H^k_n Z^{k+1}_n B^{k+1}_n = I_n,
  $$
where \(Z^{k+1}_n\) is the \(n \times n\) diagonal matrix as described
above, and \(I_n\) is the \(n \times n\) identity matrix. This,
combined with the fact that the extended discrete derivative matrix has an
efficient recursive representation in terms of weighted differences, means
that multiplying by \((H^k_n)^{-1}\) or its transpose can be performed in
\(O(nk)\) operations. See Section 6.2 and Appendix D of Tibshirani (2020)
for details.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Tibshirani (2020), "Divided differences, falling factorials, and
discrete splines: Another look at trend filtering and related problems",
Section 6.2.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="discrete_integ.html">discrete_integ()</a></code> for discrete integration at arbitrary query
points, and <code><a href="h_mat.html">h_mat()</a></code> for constructing the falling factorial basis matrix.</p></div>
    </div>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Addison Hu, Ryan Tibshirani.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.6.</p>
</div>

      </footer></div>

  


  

  </body></html>

